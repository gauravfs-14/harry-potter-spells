{"version":3,"sources":["data-viz/radial-chart/utils.js","data-viz/radial-chart/MovingPiece.jsx","data-viz/radial-chart/CustomRadialChart.jsx","article-sections/BookProgression.jsx","data-viz/semiotic-bar-charts/RadialChart.jsx","article-sections/SmallMultiples.jsx","App.js","index.js"],"names":["mostMentions","data","_","get","maxBy","d","mentions","getPath","book","spell","orderBy","spells","numBars","length","i","findIndex","scale","scaleSqrt","domain","range","canvasWidth","pieceData","find","arc","startAngle","Math","PI","endAngle","innerRadius","outerRadius","arcGenerator","getNullPath","MovingPiece","pathA","pathB","useState","mouseLocation","setMouseLocation","showLabel","setShowLabel","insignificant","animations","useSpring","config","duration","opacity","from","pieceClass","type","toLowerCase","labelX","isNull","window","innerWidth","x","labelY","innerHeight","y","textX","labelWidth","textY","labelHeight","textSize","className","onMouseEnter","e","nativeEvent","clientX","clientY","onMouseLeave","path","fill","height","width","rx","style","font","textAnchor","Pieces","styled","g","canvasHeight","SVGCanvas","svg","CustomRadialChart","fullData","currentBook","previousBook","visibleSpells","map","previousSpells","entering","includes","key","Wrapper","div","ScrollamaWrapper","StepWrapper","Loading","BookProgression","setBook","setPreviousBook","isEmpty","onStepEnter","direction","offset","OrdinalFrame","props","$sticky","h3","GlobalStyle","createGlobalStyle","AppWrapper","App","useEffect","scrollTo","top","behavior","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.90b75c4c.chunk.js","sourcesContent":["import _ from \"lodash\";\nimport spells from \"../../data/spellCounts.json\";\nimport { arc } from \"d3-shape\";\nimport { scaleSqrt } from \"d3-scale\";\n\nexport const canvasWidth = 800;\nexport const canvasHeight = 800;\nexport const margin = 100;\n\nexport const labelHeight = 80;\nexport const labelWidth = 180;\nexport const labelRx = 10;\nexport const labelMargin = 20;\nexport const textSize = 14;\n\nexport const mostMentions = (data) => {\n  return _.get(\n    _.maxBy(data, (d) => d.mentions),\n    \"mentions\"\n  );\n};\n\nexport const getPath = (book, spell) => {\n  const data = _.orderBy(spells[book], [\"mentions\"], [\"desc\"]);\n  const numBars = data.length;\n  const i = _.findIndex(data, { spell });\n\n  if (i === -1) return null;\n  const scale = scaleSqrt()\n    .domain([0, mostMentions(data)])\n    .range([0, canvasWidth / 2]);\n\n  const pieceData = _.find(data, { spell });\n\n  const arcGenerator = arc()\n    .startAngle(((Math.PI * 2) / numBars) * i)\n    .endAngle(((Math.PI * 2) / numBars) * (i + 1))\n    .innerRadius(0)\n    .outerRadius(scale(pieceData.mentions));\n\n  return arcGenerator();\n};\n\nexport const getNullPath = (book, spell) => {\n  const data = _.orderBy(spells[book], [\"mentions\"], [\"desc\"]);\n  const numBars = data.length;\n  const i = _.findIndex(data, { spell });\n\n  if (i === -1) return null;\n\n  const arcGenerator = arc()\n    .startAngle(((Math.PI * 2) / numBars) * i)\n    .endAngle(((Math.PI * 2) / numBars) * (i + 1))\n    .innerRadius(0)\n    .outerRadius(5);\n\n  return arcGenerator();\n};\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { animated, useSpring } from \"react-spring\";\nimport _ from \"lodash\";\nimport {\n  labelHeight,\n  labelWidth,\n  labelRx,\n  labelMargin,\n  textSize,\n} from \"./utils.js\";\n\nconst MovingPiece = ({ data, pathA, pathB }) => {\n  const [mouseLocation, setMouseLocation] = useState(null);\n  const [showLabel, setShowLabel] = useState(false);\n\n  const insignificant = data.mentions < 3;\n\n  const animations = useSpring({\n    config: { duration: 1500 },\n    d: pathB,\n    opacity: insignificant ? 0.4 : 1,\n    from: { d: pathA, opacity: 0 },\n  });\n\n  const pieceClass = `${\n    insignificant ? \"insignificant \" : \"\"\n  }${data.type.toLowerCase()}`;\n\n  const labelX = _.isNull(mouseLocation)\n    ? 0\n    : -window.innerWidth / 2 + mouseLocation.x;\n  const labelY = _.isNull(mouseLocation)\n    ? 0\n    : -window.innerHeight / 2 + mouseLocation.y;\n  const textX = labelX + labelWidth / 2;\n  const textY = labelY + labelHeight / 2 + textSize / 2;\n\n  return (\n    <>\n      <g>\n        <g\n          className={pieceClass}\n          onMouseEnter={(e) => {\n            setMouseLocation({\n              x: e.nativeEvent.clientX,\n              y: e.nativeEvent.clientY,\n            });\n            setShowLabel(true);\n          }}\n          onMouseLeave={() => {\n            setShowLabel(false);\n            setMouseLocation(null);\n          }}\n        >\n          <animated.path {...animations} />\n        </g>\n\n        {showLabel ? (\n          <g>\n            <rect\n              fill=\"white\"\n              x={labelX}\n              y={labelY}\n              height={labelHeight}\n              width={labelWidth}\n              rx={labelRx}\n            ></rect>\n            <text\n              x={textX}\n              y={textY}\n              style={{ font: `${textSize}px` }}\n              textAnchor={\"middle\"}\n            >\n              {data.spell} : {data.mentions}\n            </text>\n          </g>\n        ) : null}\n      </g>\n    </>\n  );\n};\n\nexport default MovingPiece;\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport _ from \"lodash\";\nimport \"./CustomRadialChart.css\";\nimport MovingPiece from \"./MovingPiece.jsx\";\nimport {\n  canvasWidth,\n  canvasHeight,\n  margin,\n  getPath,\n  getNullPath,\n} from \"./utils.js\";\n\nconst Pieces = styled.g`\n  transform: translate(${canvasWidth / 2}px, ${canvasHeight / 2}px);\n`;\n\nconst SVGCanvas = styled.svg`\n  //margin: ${margin}px;\n  position: sticky;\n  top: ${margin}px;\n`;\n\nconst CustomRadialChart = ({ fullData, currentBook, previousBook }) => {\n  const visibleSpells = _.map(fullData[currentBook], (d) => d.spell);\n  const previousSpells = _.map(fullData[previousBook], (d) => d.spell);\n\n  return (\n    <>\n      <SVGCanvas height={canvasHeight} width={canvasWidth}>\n        <Pieces>\n          {_.map(fullData[currentBook], (d) => {\n            const entering =\n              visibleSpells.includes(d.spell) &&\n              !previousSpells.includes(d.spell);\n\n            return (\n              <MovingPiece\n                key={`${d.spell}${d.book}`}\n                data={d}\n                pathA={\n                  entering\n                    ? getNullPath(currentBook, d.spell)\n                    : getPath(previousBook, d.spell)\n                }\n                pathB={getPath(currentBook, d.spell)}\n              />\n            );\n          })}\n        </Pieces>\n      </SVGCanvas>\n    </>\n  );\n};\n\nexport default CustomRadialChart;\n","import React, { useState } from \"react\";\nimport { Scrollama, Step } from \"react-scrollama\";\nimport styled from \"styled-components\";\nimport CustomRadialChart from \"../data-viz/radial-chart/CustomRadialChart.jsx\";\nimport spells from \"../data/spellCounts.json\";\nimport _ from \"lodash\";\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n`;\n\nconst ScrollamaWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst StepWrapper = styled.div`\n  margin: 50vh 0;\n  font-size: 50px;\n  height: 200px;\n  display: flex;\n  align-items: center;\n`;\n\nconst Loading = styled.div`\n  margin-top: 40px;\n`;\n\nconst BookProgression = () => {\n  const [book, setBook] = useState(1);\n  const [previousBook, setPreviousBook] = useState(0);\n\n  const onStepEnter = ({ data, direction }) => {\n    if (direction === \"up\") setPreviousBook(data + 1);\n    else if (direction === \"down\") setPreviousBook(data - 1);\n    setBook(data);\n  };\n\n  return !_.isEmpty(spells[book]) ? (\n    <Wrapper>\n      <ScrollamaWrapper>\n        <Scrollama onStepEnter={onStepEnter} offset={0.5} offset={0.7}>\n          {_.range(1, 8).map((book) => (\n            <Step data={book} key={book}>\n              <StepWrapper>{book}</StepWrapper>\n            </Step>\n          ))}\n        </Scrollama>\n      </ScrollamaWrapper>\n      <div>\n        <CustomRadialChart\n          fullData={spells}\n          currentBook={book}\n          previousBook={previousBook}\n        />\n      </div>\n    </Wrapper>\n  ) : (\n    <Loading>Loading...</Loading>\n  );\n};\n\nexport default BookProgression;\n","import React from \"react\";\nimport OrdinalFrame from \"semiotic/lib/OrdinalFrame\";\nimport styled from \"styled-components\";\nimport { scaleSqrt } from \"d3-scale\";\nimport \"./RadialChart.css\";\n\nconst Chart = styled(OrdinalFrame)`\n  position: ${(props) => (props.$sticky ? \"sticky\" : null)};\n  top: ${(props) => (props.$sticky ? 0 : null)};\n`;\n\nconst Tooltip = styled.div`\n  display: flex;\n  background-color: white;\n  color: black;\n  border-radius: 10px;\n  height: 80px;\n  width: 180px;\n  justify-content: center;\n  align-items: center;\n  padding: 5px;\n`;\n\nconst RadialChart = ({ data, xAxis, yAxis, width, height, margin, sticky }) => {\n  const frameProps = {\n    /* --- Data --- */\n    data,\n\n    /* --- Size --- */\n    size: [width, height],\n    margin: margin ? margin : 100,\n\n    /* --- Layout --- */\n    type: \"bar\",\n    projection: \"radial\",\n\n    /* --- Process --- */\n    oAccessor: xAxis,\n    rAccessor: yAxis,\n    rScaleType: scaleSqrt(),\n    oSort: (a, b, aData, bData) => bData[0][yAxis] - aData[0][yAxis],\n\n    /* --- Customize --- */\n    pieceClass: (d) => {\n      let myClass = d.type.toLowerCase();\n      if (d[yAxis] < 3) {\n        myClass += \" insignificant\";\n      }\n      return myClass;\n    },\n    baseMarkProps: {\n      transitionDuration: { default: 2000 },\n    },\n    renderKey: (datapoint) => datapoint.spell,\n\n    /* --- Interact --- */\n    hoverAnnotation: true,\n    tooltipContent: (d) => (\n      <Tooltip>\n        {d.summary[0].data[xAxis]} : {d.summary[0].data[yAxis]}\n      </Tooltip>\n    ),\n\n    /* --- Annotate --- */\n    // oLabel: {\n    //   orient: \"stem\",\n    //   padding: 5,\n    //   label: (d) => (\n    //     <text fill=\"white\" fontSize={12}>\n    //       {d}\n    //     </text>\n    //   ),\n    // },\n  };\n\n  return <Chart {...frameProps} $sticky={sticky} />;\n};\n\nexport default RadialChart;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport RadialChart from \"../data-viz/semiotic-bar-charts/RadialChart.jsx\";\nimport spells from \"../data/spellCounts.json\";\nimport bookTitles from \"../data/bookTitles.js\";\nimport _ from \"lodash\";\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: center;\n`;\n\nconst MultipleWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\n\nconst Title = styled.h3`\n  text-align: center;\n`;\n\nconst SmallMultiples = () => {\n  return (\n    <Wrapper>\n      {_.range(1, 8).map((book) => (\n        <MultipleWrapper>\n          <Title key={`title-${book}`}>{bookTitles[book]}</Title>\n          <RadialChart\n            key={`chart-${book}`}\n            data={spells[book]}\n            xAxis={\"spell\"}\n            yAxis={\"mentions\"}\n            width={500}\n            height={500}\n            sticky={false}\n            margin={50}\n          />\n        </MultipleWrapper>\n      ))}\n    </Wrapper>\n  );\n};\n\nexport default SmallMultiples;\n","import React, { useEffect } from \"react\";\nimport styled, { createGlobalStyle } from \"styled-components\";\nimport BookProgression from \"./article-sections/BookProgression.jsx\";\nimport SmallMultiples from \"./article-sections/SmallMultiples.jsx\";\n\nconst GlobalStyle = createGlobalStyle`\n  body {\n    background: #302f2c;\n    margin: 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    color: white;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',\n      monospace;\n  }\n`;\n\nconst AppWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\n\nfunction App() {\n  // Scroll to the top on render *smoooooothly*\n  useEffect(() => {\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  }, []);\n\n  return (\n    <>\n      <GlobalStyle />\n\n      <AppWrapper>\n        <BookProgression />\n        {/* <SmallMultiples /> */}\n      </AppWrapper>\n    </>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}