{"version":3,"sources":["data-viz/radial-chart/MovingPiece.jsx","data-viz/radial-chart/utils.js","data-viz/radial-chart/CustomRadialChart.jsx","article-sections/BookProgression.jsx","data-viz/semiotic-bar-charts/RadialChart.jsx","article-sections/SmallMultiples.jsx","App.js","index.js"],"names":["MovingPiece","data","pathA","pathB","insignificant","mentions","animations","useSpring","config","duration","d","opacity","from","pieceClass","type","toLowerCase","className","path","mostMentions","_","get","maxBy","getPath","book","spell","orderBy","spells","numBars","length","i","findIndex","scale","scaleSqrt","domain","range","canvasWidth","pieceData","find","arc","startAngle","Math","PI","endAngle","innerRadius","outerRadius","arcGenerator","getNullPath","Pieces","styled","g","canvasHeight","SVGCanvas","div","props","$y","$x","svg","CustomRadialChart","fullData","currentBook","previousBook","visibleSpells","map","previousSpells","height","width","entering","includes","key","Wrapper","ScrollamaWrapper","StepWrapper","Loading","BookProgression","useState","setBook","setPreviousBook","isEmpty","onStepEnter","direction","offset","OrdinalFrame","$sticky","h3","GlobalStyle","createGlobalStyle","AppWrapper","App","useEffect","window","scrollTo","top","behavior","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a921125a.chunk.js","sourcesContent":["import React from \"react\";\nimport { animated, useSpring } from \"react-spring\";\n\nconst MovingPiece = ({ data, pathA, pathB }) => {\n  const insignificant = data.mentions < 3;\n\n  const animations = useSpring({\n    config: { duration: 1500 },\n    d: pathB,\n    opacity: insignificant ? 0.4 : 1,\n    from: { d: pathA, opacity: 0 },\n  });\n\n  const pieceClass = `${\n    insignificant ? \"insignificant \" : \"\"\n  }${data.type.toLowerCase()}`;\n\n  return (\n    <g className={pieceClass}>\n      <animated.path {...animations} />\n    </g>\n  );\n};\n\nexport default MovingPiece;\n","import _ from \"lodash\";\nimport spells from \"../../data/spellCounts.json\";\nimport { arc } from \"d3-shape\";\nimport { scaleSqrt } from \"d3-scale\";\n\nexport const canvasWidth = 800;\nexport const canvasHeight = 800;\nexport const margin = 100;\n\nexport const mostMentions = (data) => {\n  return _.get(\n    _.maxBy(data, (d) => d.mentions),\n    \"mentions\"\n  );\n};\n\nexport const getPath = (book, spell) => {\n  const data = _.orderBy(spells[book], [\"mentions\"], [\"desc\"]);\n  const numBars = data.length;\n  const i = _.findIndex(data, { spell });\n\n  if (i === -1) return null;\n  const scale = scaleSqrt()\n    .domain([0, mostMentions(data)])\n    .range([0, canvasWidth / 2]);\n\n  const pieceData = _.find(data, { spell });\n\n  const arcGenerator = arc()\n    .startAngle(((Math.PI * 2) / numBars) * i)\n    .endAngle(((Math.PI * 2) / numBars) * (i + 1))\n    .innerRadius(0)\n    .outerRadius(scale(pieceData.mentions));\n\n  return arcGenerator();\n};\n\nexport const getNullPath = (book, spell) => {\n  const data = _.orderBy(spells[book], [\"mentions\"], [\"desc\"]);\n  const numBars = data.length;\n  const i = _.findIndex(data, { spell });\n\n  if (i === -1) return null;\n\n  const arcGenerator = arc()\n    .startAngle(((Math.PI * 2) / numBars) * i)\n    .endAngle(((Math.PI * 2) / numBars) * (i + 1))\n    .innerRadius(0)\n    .outerRadius(5);\n\n  return arcGenerator();\n};\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport _ from \"lodash\";\nimport \"./CustomRadialChart.css\";\nimport MovingPiece from \"./MovingPiece.jsx\";\nimport {\n  canvasWidth,\n  canvasHeight,\n  margin,\n  getPath,\n  getNullPath,\n} from \"./utils.js\";\n\nconst Pieces = styled.g`\n  transform: translate(${canvasWidth / 2}px, ${canvasHeight / 2}px);\n`;\n\nconst Tooltip = styled.div`\n  position: absolute;\n  top: ${(props) => props.$y}px;\n  left: ${(props) => props.$x}px;\n  display: flex;\n  background-color: white;\n  color: black;\n  border-radius: 10px;\n  height: 80px;\n  width: 180px;\n  justify-content: center;\n  align-items: center;\n  padding: 5px;\n`;\n\nconst SVGCanvas = styled.svg`\n  //margin: ${margin}px;\n  position: sticky;\n  top: ${margin}px;\n`;\n\nconst CustomRadialChart = ({ fullData, currentBook, previousBook }) => {\n  const visibleSpells = _.map(fullData[currentBook], (d) => d.spell);\n  const previousSpells = _.map(fullData[previousBook], (d) => d.spell);\n\n  return (\n    <>\n      <SVGCanvas height={canvasHeight} width={canvasWidth}>\n        <Pieces>\n          {_.map(fullData[currentBook], (d) => {\n            const entering =\n              visibleSpells.includes(d.spell) &&\n              !previousSpells.includes(d.spell);\n\n            return (\n              <MovingPiece\n                key={`${d.spell}${d.book}`}\n                data={d}\n                pathA={\n                  entering\n                    ? getNullPath(currentBook, d.spell)\n                    : getPath(previousBook, d.spell)\n                }\n                pathB={getPath(currentBook, d.spell)}\n              />\n            );\n          })}\n        </Pieces>\n      </SVGCanvas>\n    </>\n  );\n};\n\nexport default CustomRadialChart;\n","import React, { useState } from \"react\";\nimport { Scrollama, Step } from \"react-scrollama\";\nimport styled from \"styled-components\";\nimport CustomRadialChart from \"../data-viz/radial-chart/CustomRadialChart.jsx\";\nimport spells from \"../data/spellCounts.json\";\nimport _ from \"lodash\";\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n`;\n\nconst ScrollamaWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst StepWrapper = styled.div`\n  margin: 50vh 0;\n  font-size: 50px;\n  height: 200px;\n  display: flex;\n  align-items: center;\n`;\n\nconst Loading = styled.div`\n  margin-top: 40px;\n`;\n\nconst BookProgression = () => {\n  const [book, setBook] = useState(1);\n  const [previousBook, setPreviousBook] = useState(0);\n\n  const onStepEnter = ({ data, direction }) => {\n    if (direction === \"up\") setPreviousBook(data + 1);\n    else if (direction === \"down\") setPreviousBook(data - 1);\n    setBook(data);\n  };\n\n  return !_.isEmpty(spells[book]) ? (\n    <Wrapper>\n      <ScrollamaWrapper>\n        <Scrollama onStepEnter={onStepEnter} offset={0.5} offset={0.7}>\n          {_.range(1, 8).map((book) => (\n            <Step data={book} key={book}>\n              <StepWrapper>{book}</StepWrapper>\n            </Step>\n          ))}\n        </Scrollama>\n      </ScrollamaWrapper>\n      <div>\n        <CustomRadialChart\n          fullData={spells}\n          currentBook={book}\n          previousBook={previousBook}\n        />\n      </div>\n    </Wrapper>\n  ) : (\n    <Loading>Loading...</Loading>\n  );\n};\n\nexport default BookProgression;\n","import React from \"react\";\nimport OrdinalFrame from \"semiotic/lib/OrdinalFrame\";\nimport styled from \"styled-components\";\nimport { scaleSqrt } from \"d3-scale\";\nimport \"./RadialChart.css\";\n\nconst Chart = styled(OrdinalFrame)`\n  position: ${(props) => (props.$sticky ? \"sticky\" : null)};\n  top: ${(props) => (props.$sticky ? 0 : null)};\n`;\n\nconst Tooltip = styled.div`\n  display: flex;\n  background-color: white;\n  color: black;\n  border-radius: 10px;\n  height: 80px;\n  width: 180px;\n  justify-content: center;\n  align-items: center;\n  padding: 5px;\n`;\n\nconst RadialChart = ({ data, xAxis, yAxis, width, height, margin, sticky }) => {\n  const frameProps = {\n    /* --- Data --- */\n    data,\n\n    /* --- Size --- */\n    size: [width, height],\n    margin: margin ? margin : 100,\n\n    /* --- Layout --- */\n    type: \"bar\",\n    projection: \"radial\",\n\n    /* --- Process --- */\n    oAccessor: xAxis,\n    rAccessor: yAxis,\n    rScaleType: scaleSqrt(),\n    oSort: (a, b, aData, bData) => bData[0][yAxis] - aData[0][yAxis],\n\n    /* --- Customize --- */\n    pieceClass: (d) => {\n      let myClass = d.type.toLowerCase();\n      if (d[yAxis] < 3) {\n        myClass += \" insignificant\";\n      }\n      return myClass;\n    },\n    baseMarkProps: {\n      transitionDuration: { default: 2000 },\n    },\n    renderKey: (datapoint) => datapoint.spell,\n\n    /* --- Interact --- */\n    hoverAnnotation: true,\n    tooltipContent: (d) => (\n      <Tooltip>\n        {d.summary[0].data[xAxis]} : {d.summary[0].data[yAxis]}\n      </Tooltip>\n    ),\n\n    /* --- Annotate --- */\n    // oLabel: {\n    //   orient: \"stem\",\n    //   padding: 5,\n    //   label: (d) => (\n    //     <text fill=\"white\" fontSize={12}>\n    //       {d}\n    //     </text>\n    //   ),\n    // },\n  };\n\n  return <Chart {...frameProps} $sticky={sticky} />;\n};\n\nexport default RadialChart;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport RadialChart from \"../data-viz/semiotic-bar-charts/RadialChart.jsx\";\nimport spells from \"../data/spellCounts.json\";\nimport bookTitles from \"../data/bookTitles.js\";\nimport _ from \"lodash\";\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: center;\n`;\n\nconst MultipleWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\n\nconst Title = styled.h3`\n  text-align: center;\n`;\n\nconst SmallMultiples = () => {\n  return (\n    <Wrapper>\n      {_.range(1, 8).map((book) => (\n        <MultipleWrapper>\n          <Title key={`title-${book}`}>{bookTitles[book]}</Title>\n          <RadialChart\n            key={`chart-${book}`}\n            data={spells[book]}\n            xAxis={\"spell\"}\n            yAxis={\"mentions\"}\n            width={500}\n            height={500}\n            sticky={false}\n            margin={50}\n          />\n        </MultipleWrapper>\n      ))}\n    </Wrapper>\n  );\n};\n\nexport default SmallMultiples;\n","import React, { useEffect } from \"react\";\nimport styled, { createGlobalStyle } from \"styled-components\";\nimport BookProgression from \"./article-sections/BookProgression.jsx\";\nimport SmallMultiples from \"./article-sections/SmallMultiples.jsx\";\n\nconst GlobalStyle = createGlobalStyle`\n  body {\n    background: #302f2c;\n    margin: 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    color: white;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',\n      monospace;\n  }\n`;\n\nconst AppWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\n\nfunction App() {\n  // Scroll to the top on render *smoooooothly*\n  useEffect(() => {\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  }, []);\n\n  return (\n    <>\n      <GlobalStyle />\n\n      <AppWrapper>\n        <BookProgression />\n        {/* <SmallMultiples /> */}\n      </AppWrapper>\n    </>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}